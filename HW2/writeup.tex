\documentclass{article}

\usepackage{amsfonts}
\usepackage{amsmath}


\begin{document}
\begin{center}
\textbf{High Performance Computing}

\textbf{Homework 2: due 3/21/22}

\textbf{Andrew Lipnick}

\end{center}

\section*{Question 2}
I am running the code on my laptop which has an Intel Core i9-10980HK Processor. 

Below are the outputs with and withot openmp with block sizes 16, 8, and 32. We see a small speed up with openmp for block size 16, but with a block size of 8 there is a slowdown because the work in organizing the threads is larger than the work needed to be done. For a block size of 32 we see a great speedup and this gets greater as the block size increase. The code submitted has the default block size of 16 with omp.

Output with blocksize equal to 16
Blocked version with no openmp:
\begin{verbatim}
     Dimension       Time    Gflop/s       GB/s        Error
        16   0.479507   4.170954  35.453112 0.000000e+00
        64   0.494874   4.041750  32.839221 0.000000e+00
       112   0.490088   4.082157  32.948840 0.000000e+00
       160   0.489992   4.096064  32.973318 0.000000e+00
       208   0.511574   3.940302  31.673970 0.000000e+00
       256   0.512991   3.924565  31.519159 0.000000e+00
       304   0.492610   4.106292  32.958398 0.000000e+00
       352   0.490100   4.093556  32.841486 0.000000e+00
       400   0.498517   4.108187  32.947656 0.000000e+00
       448   0.553213   3.900794  31.276007 0.000000e+00
       496   0.580283   3.785105  30.341889 0.000000e+00
       544   0.550685   4.092808  32.802649 0.000000e+00
       592   0.521065   3.981740  31.907726 0.000000e+00
       640   0.530063   3.956420  31.700817 0.000000e+00
       688   0.638600   4.079681  32.684884 0.000000e+00
       736   0.578048   4.138290  33.151303 0.000000e+00
       784   0.705514   4.098204  32.827449 0.000000e+00
       832   0.570982   4.034666  32.316126 0.000000e+00
       880   0.667935   4.081065  32.685623 0.000000e+00
       928   0.778205   4.107806  32.897858 0.000000e+00
       976   0.923151   4.028438  32.260525 0.000000e+00
      1024   0.650377   3.301908  26.441064 0.000000e+00
      1072   0.600172   4.105241  32.872561 0.000000e+00
      1120   0.704796   3.986768  31.922619 0.000000e+00
      1168   0.781531   4.077671  32.649299 0.000000e+00
      1216   0.916448   3.923946  31.417381 0.000000e+00
      1264   1.005110   4.018442  32.172970 0.000000e+00
      1312   1.147429   3.936457  31.515663 0.000000e+00
      1360   1.261393   3.988379  31.930492 0.000000e+00
      1408   1.414849   3.945736  31.588305 0.000000e+00
      1456   1.638780   3.766981  30.156545 0.000000e+00
      1504   1.757668   3.871120  30.989551 0.000000e+00
      1552   2.021703   3.698179  29.604491 0.000000e+00
      1600   2.072999   3.951763  31.633866 0.000000e+00
      1648   2.334594   3.834337  30.693311 0.000000e+00
      1696   2.532625   3.852447  30.837750 0.000000e+00
      1744   2.782259   3.813044  30.521844 0.000000e+00
      1792   3.113534   3.696497  29.588481 0.000000e+00
      1840   3.518625   3.540874  28.342388 0.000000e+00
      1888   3.608982   3.729505  29.851845 0.000000e+00
      1936   3.839208   3.780110  30.256499 0.000000e+00
      1984   4.093367   3.815701  30.540994 0.000000e+00
\end{verbatim}

with openmp
\begin{verbatim}
     Dimension       Time    Gflop/s       GB/s        Error
        16   0.501572   3.987466  33.893464 0.000000e+00
        64   0.506178   3.951494  32.105885 0.000000e+00
       112   0.440331   4.543439  36.672043 0.000000e+00
       160   0.603885   3.323545  26.754533 0.000000e+00
       208   0.620597   3.248093  26.109669 0.000000e+00
       256   0.602076   3.343875  26.855497 0.000000e+00
       304   0.807424   2.505254  20.107962 0.000000e+00
       352   0.893625   2.245074  18.011620 0.000000e+00
       400   0.620588   3.300096  26.466770 0.000000e+00
       448   0.631123   3.419254  27.415089 0.000000e+00
       496   0.854702   2.569820  20.600007 0.000000e+00
       544   0.783621   2.876198  23.051881 0.000000e+00
       592   0.726867   2.854371  22.873537 0.000000e+00
       640   0.599071   3.500676  28.049165 0.000000e+00
       688   0.695951   3.743490  29.991446 0.000000e+00
       736   0.549600   4.352490  34.867232 0.000000e+00
       784   0.670643   4.311295  34.534356 0.000000e+00
       832   0.520653   4.424681  35.439990 0.000000e+00
       880   0.623278   4.373473  35.027546 0.000000e+00
       928   0.713427   4.480789  35.884940 0.000000e+00
       976   0.821420   4.527353  36.255931 0.000000e+00
      1024   0.522266   4.111859  32.926994 0.000000e+00
      1072   0.577306   4.267842  34.174587 0.000000e+00
      1120   0.693564   4.051331  32.439585 0.000000e+00
      1168   0.746000   4.271885  34.204342 0.000000e+00
      1216   0.858916   4.186780  33.521784 0.000000e+00
      1264   0.980534   4.119157  32.979329 0.000000e+00
      1312   1.087841   4.152083  33.241979 0.000000e+00
      1360   1.278357   3.935450  31.506752 0.000000e+00
      1408   1.295831   4.308138  34.489581 0.000000e+00
      1456   1.468567   4.203590  33.651819 0.000000e+00
      1504   1.783572   3.814898  30.539476 0.000000e+00
      1552   1.847806   4.046212  32.390556 0.000000e+00
      1600   2.002932   4.090004  32.740481 0.000000e+00
      1648   2.139268   4.184430  33.495755 0.000000e+00
      1696   2.328424   4.190304  33.542196 0.000000e+00
      1744   2.589858   4.096317  32.789325 0.000000e+00
      1792   2.889852   3.982616  31.878704 0.000000e+00
      1840   3.040034   4.098311  32.804310 0.000000e+00
      1888   3.247172   4.145058  33.178029 0.000000e+00
      1936   3.486015   4.163099  33.321996 0.000000e+00
      1984   4.024973   3.880539  31.059956 0.000000e+00
\end{verbatim}

With block size 8
without openmp
\begin{verbatim}
     Dimension       Time    Gflop/s       GB/s        Error
         8   0.484535   4.127675  37.149077 0.000000e+00
        56   0.496167   4.031437  32.827419 0.000000e+00
       104   0.504369   3.965364  32.027939 0.000000e+00
       152   0.501347   3.992709  32.151813 0.000000e+00
       200   0.516641   3.902128  31.373108 0.000000e+00
       248   0.507198   3.969641  31.885177 0.000000e+00
       296   0.513863   3.936608  31.599262 0.000000e+00
       344   0.522884   3.892606  31.231370 0.000000e+00
       392   0.518867   3.947128  31.657579 0.000000e+00
       440   0.520077   3.930990  31.519394 0.000000e+00
       488   0.542882   3.853246  30.889138 0.000000e+00
       536   0.543685   3.965289  31.781493 0.000000e+00
       584   0.601263   3.975170  31.855812 0.000000e+00
       632   0.512058   3.943867  31.600857 0.000000e+00
       680   0.648020   3.881755  31.099707 0.000000e+00
       728   0.573154   4.039003  32.356406 0.000000e+00
       776   0.697356   4.020516  32.205573 0.000000e+00
       824   0.570233   3.924543  31.434443 0.000000e+00
       872   0.694426   3.819295  30.589401 0.000000e+00
       920   0.788504   3.950204  31.635981 0.000000e+00
       968   0.916909   3.956944  31.688252 0.000000e+00
      1016   0.533025   3.935173  31.512366 0.000000e+00
      1064   0.613787   3.924980  31.429348 0.000000e+00
      1112   0.693219   3.967107  31.765395 0.000000e+00
      1160   0.787971   3.961809  31.721797 0.000000e+00
      1208   0.899387   3.919982  31.385814 0.000000e+00
      1256   1.029975   3.847443  30.804050 0.000000e+00
      1304   1.163591   3.811207  30.513034 0.000000e+00
      1352   1.288107   3.837143  30.719850 0.000000e+00
      1400   1.481601   3.704102  29.653980 0.000000e+00
      1448   1.670314   3.635278  29.102307 0.000000e+00
      1496   1.899542   3.525136  28.219942 0.000000e+00
      1544   2.681334   2.745497  21.978198 0.000000e+00
      1592   2.552253   3.161808  25.310355 0.000000e+00
      1640   3.044705   2.897452  23.193754 0.000000e+00
      1688   3.382639   2.843752  22.763494 0.000000e+00
      1736   3.377233   3.098261  24.800370 0.000000e+00
      1784   3.493815   3.250235  26.016451 0.000000e+00
      1832   4.057936   3.030409  24.256505 0.000000e+00
      1880   4.252464   3.125093  25.014042 0.000000e+00
      1928   4.464600   3.210470  25.697077 0.000000e+00
      1976   4.703562   3.280681  26.258729 0.000000e+00
\end{verbatim}

with openmp
\begin{verbatim}
 Dimension       Time    Gflop/s       GB/s        Error
         8   3.484161   0.574027   5.166240 0.000000e+00
        56   3.506087   0.570512   4.645601 0.000000e+00
       104   3.711086   0.538928   4.352880 0.000000e+00
       152   3.685955   0.543070   4.373141 0.000000e+00
       200   4.547864   0.443285   3.564012 0.000000e+00
       248   4.020530   0.500779   4.022382 0.000000e+00
       296   3.869262   0.522807   4.196588 0.000000e+00
       344   3.483038   0.584369   4.688541 0.000000e+00
       392   3.488771   0.587036   4.708268 0.000000e+00
       440   3.497598   0.584520   4.686788 0.000000e+00
       488   3.607585   0.579850   4.648303 0.000000e+00
       536   4.229333   0.509742   4.085545 0.000000e+00
       584   4.539232   0.526547   4.219592 0.000000e+00
       632   3.822211   0.528356   4.233536 0.000000e+00
       680   4.732841   0.531490   4.258170 0.000000e+00
       728   4.508574   0.513460   4.113319 0.000000e+00
       776   5.388279   0.520339   4.168076 0.000000e+00
       824   4.118010   0.543443   4.352822 0.000000e+00
       872   5.149818   0.515012   4.124823 0.000000e+00
       920   5.935011   0.524810   4.203042 0.000000e+00
       968   6.866150   0.528412   4.231664 0.000000e+00
      1016   4.000894   0.524269   4.198279 0.000000e+00
      1064   4.713246   0.511134   4.092915 0.000000e+00
      1112   5.241937   0.524629   4.200809 0.000000e+00
      1160   5.987260   0.521406   4.174842 0.000000e+00
      1208   6.866609   0.513439   4.110909 0.000000e+00
      1256   7.597373   0.521597   4.176102 0.000000e+00
      1304   8.520469   0.520474   4.166987 0.000000e+00
      1352   8.816910   0.560588   4.488020 0.000000e+00
      1400  10.421287   0.526614   4.215925 0.000000e+00
      1448  13.014182   0.466572   3.735155 0.000000e+00
      1496  18.797491   0.356225   2.851708 0.000000e+00
      1544  14.341918   0.513292   4.108997 0.000000e+00
      1592  15.504743   0.520469   4.166365 0.000000e+00
      1640  17.142579   0.514618   4.119458 0.000000e+00
      1688  18.578526   0.517769   4.144606 0.000000e+00
      1736  19.775150   0.529126   4.235449 0.000000e+00
      1784  21.352124   0.531831   4.257031 0.000000e+00
      1832  22.954740   0.535715   4.288062 0.000000e+00
      1880  26.692823   0.497862   3.985015 0.000000e+00
      1928  27.671522   0.517986   4.146037 0.000000e+00
      1976  29.011354   0.531891   4.257283 0.000000e+00
\end{verbatim}

With block size 32
without openmp
\begin{verbatim}
     Dimension       Time    Gflop/s       GB/s        Error
        32   0.566817   3.528523  29.110317 0.000000e+00
        64   0.584123   3.424209  27.821696 0.000000e+00
        96   0.573867   3.487346  28.189381 0.000000e+00
       128   0.577684   3.463282  27.922707 0.000000e+00
       160   0.578060   3.472030  27.949843 0.000000e+00
       192   0.572769   3.509481  28.222077 0.000000e+00
       224   0.565662   3.536774  28.420504 0.000000e+00
       256   0.681717   2.953228  23.718111 0.000000e+00
       288   0.581095   3.453107  27.720772 0.000000e+00
       320   0.578903   3.509425  28.163136 0.000000e+00
       352   0.584902   3.430066  27.518485 0.000000e+00
       384   0.645978   3.155577  25.310357 0.000000e+00
       416   0.580423   3.472911  27.850073 0.000000e+00
       448   0.623212   3.462659  27.763103 0.000000e+00
       480   0.641413   3.448389  27.644588 0.000000e+00
       512   0.864462   2.484187  19.912308 0.000000e+00
       544   0.656525   3.432998  27.514472 0.000000e+00
       576   0.666932   3.438485  27.555637 0.000000e+00
       608   0.652257   3.445814  27.611853 0.000000e+00
       640   0.632070   3.317914  26.584783 0.000000e+00
       672   0.697927   3.478466  27.869141 0.000000e+00
       704   0.608567   3.440022  27.559265 0.000000e+00
       736   0.695833   3.437791  27.539696 0.000000e+00
       768   0.873561   3.111298  24.922797 0.000000e+00
       800   0.594008   3.447764  27.616593 0.000000e+00
       832   0.670008   3.438349  27.539851 0.000000e+00
       864   0.741795   3.477901  27.855414 0.000000e+00
       896   0.831848   3.458916  27.702213 0.000000e+00
       928   0.926018   3.452107  27.646619 0.000000e+00
       960   1.025743   3.450127  27.629765 0.000000e+00
       992   1.136468   3.435879  27.514744 0.000000e+00
      1024   0.886720   2.421828  19.393543 0.000000e+00
      1056   0.679976   3.463606  27.735083 0.000000e+00
      1088   0.759668   3.390728  27.150753 0.000000e+00
      1120   0.824052   3.409805  27.302793 0.000000e+00
      1152   0.904640   3.379961  27.063157 0.000000e+00
      1184   0.957405   3.467283  27.761688 0.000000e+00
      1216   1.053733   3.412717  27.324187 0.000000e+00
      1248   1.132240   3.433484  27.489884 0.000000e+00
      1280   1.365738   3.071091  24.587920 0.000000e+00
      1312   1.327810   3.401698  27.234324 0.000000e+00
      1344   1.421640   3.415372  27.343309 0.000000e+00
      1376   1.545213   3.372073  26.996191 0.000000e+00
      1408   1.674955   3.332995  26.682901 0.000000e+00
      1440   1.769216   3.375488  27.022655 0.000000e+00
      1472   1.871449   3.408596  27.287294 0.000000e+00
      1504   1.984645   3.428394  27.445387 0.000000e+00
      1536   2.892141   2.506018  20.061197 0.000000e+00
      1568   2.256945   3.416231  27.347274 0.000000e+00
      1600   2.397611   3.416734  27.350958 0.000000e+00
      1632   2.571498   3.380681  27.062021 0.000000e+00
      1664   2.726298   3.379999  27.056242 0.000000e+00
      1696   2.848756   3.424935  27.415636 0.000000e+00
      1728   3.006785   3.432092  27.472622 0.000000e+00
      1760   3.180529   3.428220  27.441340 0.000000e+00
      1792   3.760903   3.060215  24.495380 0.000000e+00
      1824   3.545763   3.422905  27.398250 0.000000e+00
      1856   3.790173   3.373687  27.004041 0.000000e+00
      1888   3.992866   3.370942  26.981817 0.000000e+00
      1920   4.233768   3.343541  26.762257 0.000000e+00
      1952   4.378457   3.397413  27.193231 0.000000e+00
      1984   4.595429   3.398826  27.204314 0.000000e+00
\end{verbatim}

with openmp
\begin{verbatim}
 Dimension       Time    Gflop/s       GB/s        Error
        32   0.268476   7.449567  61.458926 0.000000e+00
        64   0.278754   7.175357  58.299775 0.000000e+00
        96   0.126598  15.808129 127.782380 0.000000e+00
       128   0.115237  17.361494 139.977045 0.000000e+00
       160   0.124822  16.079230 129.437799 0.000000e+00
       192   0.113579  17.697945 142.320973 0.000000e+00
       224   0.114262  17.509005 140.697364 0.000000e+00
       256   0.149921  13.428854 107.850486 0.000000e+00
       288   0.114448  17.532674 140.748412 0.000000e+00
       320   0.115313  17.618350 141.387260 0.000000e+00
       352   0.117136  17.127528 137.409488 0.000000e+00
       384   0.140169  14.542630 116.644013 0.000000e+00
       416   0.117271  17.188829 137.841184 0.000000e+00
       448   0.127302  16.951562 135.915200 0.000000e+00
       480   0.140369  15.757280 126.320865 0.000000e+00
       512   0.146393  14.669356 117.584054 0.000000e+00
       544   0.130223  17.307594 138.715277 0.000000e+00
       576   0.132843  17.262700 138.341357 0.000000e+00
       608   0.160604  13.994412 112.139432 0.000000e+00
       640   0.121449  17.267801 138.358257 0.000000e+00
       672   0.136114  17.835899 142.899526 0.000000e+00
       704   0.133786  15.648002 125.361831 0.000000e+00
       736   0.134313  17.810072 142.674163 0.000000e+00
       768   0.160675  16.915590 135.500922 0.000000e+00
       800   0.119945  17.074549 136.767141 0.000000e+00
       832   0.130059  17.712868 141.873262 0.000000e+00
       864   0.144349  17.872625 143.146487 0.000000e+00
       896   0.172750  16.655866 133.395642 0.000000e+00
       928   0.180921  17.669140 141.505443 0.000000e+00
       960   0.208461  16.976520 135.953630 0.000000e+00
       992   0.257593  15.158641 121.391378 0.000000e+00
      1024   0.153352  14.003651 112.138609 0.000000e+00
      1056   0.143675  16.392325 131.262781 0.000000e+00
      1088   0.146593  17.571342 140.699937 0.000000e+00
      1120   0.155927  18.020318 144.291264 0.000000e+00
      1152   0.181458  16.850480 134.920855 0.000000e+00
      1184   0.187922  17.664787 141.437651 0.000000e+00
      1216   0.209620  17.155312 137.355361 0.000000e+00
      1248   0.250858  15.496928 124.074766 0.000000e+00
      1280   0.259212  16.180979 129.548965 0.000000e+00
      1312   0.260806  17.318639 138.654712 0.000000e+00
      1344   0.322564  15.052618 120.510543 0.000000e+00
      1376   0.323157  16.123981 129.085589 0.000000e+00
      1408   0.326806  17.082378 136.756086 0.000000e+00
      1440   0.360197  16.579727 132.729927 0.000000e+00
      1472   0.384322  16.598092 132.874947 0.000000e+00
      1504   0.414227  16.426112 131.496271 0.000000e+00
      1536   0.514514  14.086611 112.766258 0.000000e+00
      1568   0.514397  14.988888 119.987576 0.000000e+00
      1600   0.503711  16.263297 130.187693 0.000000e+00
      1632   0.622180  13.972514 111.848604 0.000000e+00
      1664   0.588561  15.656637 125.328368 0.000000e+00
      1696   0.676169  14.429525 115.504262 0.000000e+00
      1728   0.630365  16.370760 131.041871 0.000000e+00
      1760   0.757187  14.400088 115.266156 0.000000e+00
      1792   0.737065  15.614873 124.988694 0.000000e+00
      1824   0.851664  14.250707 114.068159 0.000000e+00
      1856   0.882725  14.485662 115.947731 0.000000e+00
      1888   0.923829  14.569486 116.617624 0.000000e+00
      1920   0.895409  15.809294 126.540222 0.000000e+00
      1952   1.068626  13.920138 111.418153 0.000000e+00
      1984   1.050173  14.872851 119.042781 0.000000e+00
\end{verbatim}

\section*{Question 4}
\subsection*{Jacobi}
Below are the results for N = 100 and N=1000 and for number of threads equal to 1, 4, and 16. We see that more threads results in faster execution and the speed up is greater for larger N. (with the exception that while 4 threads is faster than 1 for N = 100 it is slower with 16 threads, this is because there is more overhead with more threads).

N = 100, Threads = 1
\begin{verbatim}
initial residual = 100.000000 so tolerance = 0.010000
after 18622 iterations the residual is 0.009997
Total time was 0.712711s with a total of 1 threads
\end{verbatim}

N = 100, Threads = 4
\begin{verbatim}
initial residual = 100.000000 so tolerance = 0.010000
after 18622 iterations the residual is 0.009997
Total time was 0.340120s with a total of 4 threads   
\end{verbatim}

N = 100, Threads = 16
\begin{verbatim}
intial residual = 100.000000 so tolerance = 0.010000
after 18622 iterations the residual is 0.009997
Total time was 0.343957s with a total of 16 threads
\end{verbatim}

N = 1000, Threads = 1
\begin{verbatim}
initial residual = 1000.000000 so tolerance = 0.100000
after 5000 iterations the residual is 888.157673
Total time was 33.089935s with a total of 1 threads
\end{verbatim}

N = 1000, Threads = 4
\begin{verbatim}
initial residual = 1000.000000 so tolerance = 0.100000
after 5000 iterations the residual is 888.157673
Total time was 18.381664s with a total of 4 threads
\end{verbatim}

N = 1000, Threads = 16
\begin{verbatim}
initial residual = 1000.000000 so tolerance = 0.100000
after 5000 iterations the residual is 888.157673
Total time was 12.717927s with a total of 16 threads
\end{verbatim}



\subsection*{Gauss-Seidel}
Below are the resuts for the same N and thread values as the Jacobi method. We see similar results as before with increase N and threads but additionally we note that this method is much faster than the Jacobi method. Additionally, because only one copy of $u$ is needed this method uses less memory. However, oddly for N=100 while 4 threads is worse than 1 thread 16 threads is better. Perhaps the speed up from 4 threads is small while the overhead is a lot but with 16 threads the overhead is not much more while the speedup is much greater.

N = 100, Threads = 1
\begin{verbatim}
initial residual = 100.000000 so tolerance = 0.010000
after 9769 iterations the residual is 0.010000
Total time was 0.319787s with a total of 1 threads
\end{verbatim}

N = 100, Threads = 4
\begin{verbatim}
initial residual = 100.000000 so tolerance = 0.010000
after 9769 iterations the residual is 0.010000
Total time was 4.957361s with a total of 4 threads
\end{verbatim}

N = 100, Threads = 16
\begin{verbatim}
initial residual = 100.000000 so tolerance = 0.010000
after 9769 iterations the residual is 0.010000
Total time was 0.290278s with a total of 16 threads
\end{verbatim}

N = 1000, Threads = 1
\begin{verbatim}
initial residual = 1000.000000 so tolerance = 0.100000
after 5000 iterations the residual is 1190.659893
Total time was 13.150385s with a total of 1 threads
\end{verbatim}

N = 1000, Threads = 4
\begin{verbatim}
initial residual = 1000.000000 so tolerance = 0.100000
after 5000 iterations the residual is 1190.659893
Total time was 8.486498s with a total of 4 threads
\end{verbatim}

N = 1000, Threads = 16
\begin{verbatim}
initial residual = 1000.000000 so tolerance = 0.100000
after 5000 iterations the residual is 1190.659893
Total time was 5.444008s with a total of 16 threads
\end{verbatim}

\end{document}